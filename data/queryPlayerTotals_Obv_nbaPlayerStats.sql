-- Stap 1: Nieuwe tabel aanmaken
IF OBJECT_ID('dbo.nbaPlayerTotals', 'U') IS NOT NULL
    DROP TABLE dbo.nbaPlayerTotals;
GO

CREATE TABLE dbo.nbaPlayerTotals (
    Rk				VARCHAR(50) NULL,
    Result			VARCHAR(50) NULL,
    GS				VARCHAR(50) NULL,
    MP				VARCHAR(50) NULL,
    FG				VARCHAR(50) NULL,
    FGA				VARCHAR(50) NULL,
    [FG%]			VARCHAR(50) NULL,
    [3P]			VARCHAR(50) NULL,
    [3PA]			VARCHAR(50) NULL,
	[3P%]			VARCHAR(50) NULL,
	[2P]			VARCHAR(50) NULL,
	[2PA]			VARCHAR(50) NULL,
	[2P%]			VARCHAR(50) NULL,
	[eFG%]			VARCHAR(50) NULL,
	FT				VARCHAR(50) NULL,
	FTA				VARCHAR(50) NULL,
	[FT%]			VARCHAR(50) NULL,
	ORB				VARCHAR(50) NULL,
	DRB				VARCHAR(50) NULL,
	TRB				VARCHAR(50) NULL,
	AST				VARCHAR(50) NULL,
	STL				VARCHAR(50) NULL,
	BLK				VARCHAR(50) NULL,
	TOV				VARCHAR(50) NULL,
	PF				VARCHAR(50) NULL,
	PTS				VARCHAR(50) NULL,
	GmSc			VARCHAR(50) NULL,
	[+/-]			VARCHAR(50) NULL,
	player_name     VARCHAR(50) NULL,
    team_code		VARCHAR(50) NULL
);
GO

-- Stap 2: Data invoegen op basis van de Rk filter
INSERT INTO dbo.nbaPlayerTotals (
Rk			,
Result		,
GS			,
MP			,
FG			,
FGA			,
[FG%]		,
[3P]		,
[3PA]		,
[3P%]		,
[2P]		,
[2PA]		,
[2P%]		,
[eFG%]		,
FT			,
FTA			,
[FT%]		,
ORB			,
DRB			,
TRB			,
AST			,
STL			,
BLK			,
TOV			,
PF			,
PTS			,
GmSc		,
[+/-]		,
player_name ,
team_code	

)
SELECT 
 Rk			,
Result		,
GS			,
MP			,
FG			,
FGA			,
[FG%]		,
[3P]		,
[3PA]		,
[3P%]		,
[2P]		,
[2PA]		,
[2P%]		,
[eFG%]		,
FT			,
FTA			,
[FT%]		,
ORB			,
DRB			,
TRB			,
AST			,
STL			,
BLK			,
TOV			,
PF			,
PTS			,
GmSc		,
[+ -]		,
player_name ,
team_code	
FROM dbo.nbaPlayerStats
WHERE Rk LIKE '%TOTAAL%';
